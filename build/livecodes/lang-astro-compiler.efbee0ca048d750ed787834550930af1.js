"use strict";(()=>{var z=Object.create;var E=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,K=Object.prototype.hasOwnProperty;var J=(t,o)=>()=>(o||t((o={exports:{}}).exports,o),o.exports);var H=(t,o,d,m)=>{if(o&&typeof o=="object"||typeof o=="function")for(let g of D(o))!K.call(t,g)&&g!==d&&E(t,g,{get:()=>o[g],enumerable:!(m=F(o,g))||m.enumerable});return t};var Z=(t,o,d)=>(d=t!=null?z(N(t)):{},H(o||!t||!t.__esModule?E(d,"default",{value:t,enumerable:!0}):d,t));var L=J((qt,k)=>{var M=function(){var t=String.fromCharCode,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",m={};function g(e,s){if(!m[e]){m[e]={};for(var c=0;c<e.length;c++)m[e][e.charAt(c)]=c}return m[e][s]}var u={compressToBase64:function(e){if(e==null)return"";var s=u._compress(e,6,function(c){return o.charAt(c)});switch(s.length%4){default:case 0:return s;case 1:return s+"===";case 2:return s+"==";case 3:return s+"="}},decompressFromBase64:function(e){return e==null?"":e==""?null:u._decompress(e.length,32,function(s){return g(o,e.charAt(s))})},compressToUTF16:function(e){return e==null?"":u._compress(e,15,function(s){return t(s+32)})+" "},decompressFromUTF16:function(e){return e==null?"":e==""?null:u._decompress(e.length,16384,function(s){return e.charCodeAt(s)-32})},compressToUint8Array:function(e){for(var s=u.compress(e),c=new Uint8Array(s.length*2),i=0,p=s.length;i<p;i++){var y=s.charCodeAt(i);c[i*2]=y>>>8,c[i*2+1]=y%256}return c},decompressFromUint8Array:function(e){if(e==null)return u.decompress(e);for(var s=new Array(e.length/2),c=0,i=s.length;c<i;c++)s[c]=e[c*2]*256+e[c*2+1];var p=[];return s.forEach(function(y){p.push(t(y))}),u.decompress(p.join(""))},compressToEncodedURIComponent:function(e){return e==null?"":u._compress(e,6,function(s){return d.charAt(s)})},decompressFromEncodedURIComponent:function(e){return e==null?"":e==""?null:(e=e.replace(/ /g,"+"),u._decompress(e.length,32,function(s){return g(d,e.charAt(s))}))},compress:function(e){return u._compress(e,16,function(s){return t(s)})},_compress:function(e,s,c){if(e==null)return"";var i,p,y={},b={},w="",j="",h="",v=2,U=3,l=2,f=[],r=0,n=0,x;for(x=0;x<e.length;x+=1)if(w=e.charAt(x),Object.prototype.hasOwnProperty.call(y,w)||(y[w]=U++,b[w]=!0),j=h+w,Object.prototype.hasOwnProperty.call(y,j))h=j;else{if(Object.prototype.hasOwnProperty.call(b,h)){if(h.charCodeAt(0)<256){for(i=0;i<l;i++)r=r<<1,n==s-1?(n=0,f.push(c(r)),r=0):n++;for(p=h.charCodeAt(0),i=0;i<8;i++)r=r<<1|p&1,n==s-1?(n=0,f.push(c(r)),r=0):n++,p=p>>1}else{for(p=1,i=0;i<l;i++)r=r<<1|p,n==s-1?(n=0,f.push(c(r)),r=0):n++,p=0;for(p=h.charCodeAt(0),i=0;i<16;i++)r=r<<1|p&1,n==s-1?(n=0,f.push(c(r)),r=0):n++,p=p>>1}v--,v==0&&(v=Math.pow(2,l),l++),delete b[h]}else for(p=y[h],i=0;i<l;i++)r=r<<1|p&1,n==s-1?(n=0,f.push(c(r)),r=0):n++,p=p>>1;v--,v==0&&(v=Math.pow(2,l),l++),y[j]=U++,h=String(w)}if(h!==""){if(Object.prototype.hasOwnProperty.call(b,h)){if(h.charCodeAt(0)<256){for(i=0;i<l;i++)r=r<<1,n==s-1?(n=0,f.push(c(r)),r=0):n++;for(p=h.charCodeAt(0),i=0;i<8;i++)r=r<<1|p&1,n==s-1?(n=0,f.push(c(r)),r=0):n++,p=p>>1}else{for(p=1,i=0;i<l;i++)r=r<<1|p,n==s-1?(n=0,f.push(c(r)),r=0):n++,p=0;for(p=h.charCodeAt(0),i=0;i<16;i++)r=r<<1|p&1,n==s-1?(n=0,f.push(c(r)),r=0):n++,p=p>>1}v--,v==0&&(v=Math.pow(2,l),l++),delete b[h]}else for(p=y[h],i=0;i<l;i++)r=r<<1|p&1,n==s-1?(n=0,f.push(c(r)),r=0):n++,p=p>>1;v--,v==0&&(v=Math.pow(2,l),l++)}for(p=2,i=0;i<l;i++)r=r<<1|p&1,n==s-1?(n=0,f.push(c(r)),r=0):n++,p=p>>1;for(;;)if(r=r<<1,n==s-1){f.push(c(r));break}else n++;return f.join("")},decompress:function(e){return e==null?"":e==""?null:u._decompress(e.length,32768,function(s){return e.charCodeAt(s)})},_decompress:function(e,s,c){var i=[],p,y=4,b=4,w=3,j="",h=[],v,U,l,f,r,n,x,a={val:c(0),position:s,index:1};for(v=0;v<3;v+=1)i[v]=v;for(l=0,r=Math.pow(2,2),n=1;n!=r;)f=a.val&a.position,a.position>>=1,a.position==0&&(a.position=s,a.val=c(a.index++)),l|=(f>0?1:0)*n,n<<=1;switch(p=l){case 0:for(l=0,r=Math.pow(2,8),n=1;n!=r;)f=a.val&a.position,a.position>>=1,a.position==0&&(a.position=s,a.val=c(a.index++)),l|=(f>0?1:0)*n,n<<=1;x=t(l);break;case 1:for(l=0,r=Math.pow(2,16),n=1;n!=r;)f=a.val&a.position,a.position>>=1,a.position==0&&(a.position=s,a.val=c(a.index++)),l|=(f>0?1:0)*n,n<<=1;x=t(l);break;case 2:return""}for(i[3]=x,U=x,h.push(x);;){if(a.index>e)return"";for(l=0,r=Math.pow(2,w),n=1;n!=r;)f=a.val&a.position,a.position>>=1,a.position==0&&(a.position=s,a.val=c(a.index++)),l|=(f>0?1:0)*n,n<<=1;switch(x=l){case 0:for(l=0,r=Math.pow(2,8),n=1;n!=r;)f=a.val&a.position,a.position>>=1,a.position==0&&(a.position=s,a.val=c(a.index++)),l|=(f>0?1:0)*n,n<<=1;i[b++]=t(l),x=b-1,y--;break;case 1:for(l=0,r=Math.pow(2,16),n=1;n!=r;)f=a.val&a.position,a.position>>=1,a.position==0&&(a.position=s,a.val=c(a.index++)),l|=(f>0?1:0)*n,n<<=1;i[b++]=t(l),x=b-1,y--;break;case 2:return h.join("")}if(y==0&&(y=Math.pow(2,w),w++),i[x])j=i[x];else if(x===b)j=U+U.charAt(0);else return null;h.push(j),i[b++]=U+j.charAt(0),y--,U=j,y==0&&(y=Math.pow(2,w),w++)}}};return u}();typeof define=="function"&&define.amd?define(function(){return M}):typeof k<"u"&&k!=null&&(k.exports=M)});var T=async(t,o,d,m={},g=self)=>new Promise(u=>{if(!t||!o||!d)return u(t||"");let e=async function(s){let c=s.data.payload;s.data.trigger==="compileInCompiler"&&c?.content===t&&c?.language===o&&(g.removeEventListener("message",e),u(c.compiled))};g.addEventListener("message",e),g.postMessage({type:"compileInCompiler",payload:{content:t,language:o,config:d,options:m}})});var S=(t=location.origin)=>Boolean(t&&(t.endsWith("livecodes.io")||t.endsWith("livecodes.pages.dev")||t.endsWith("localpen.io")||t.endsWith("localpen.pages.dev")||t.startsWith("http://127.0.0.1")||t.startsWith("http://localhost")));var C=t=>t.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"$1");var P=(t,o)=>({...o.customSettings[t]});var _="https://cdn.jsdelivr.net/npm/@hatemhosny/astro-internal@0.0.4/",R="https://cdn.jsdelivr.net/npm/@astrojs/compiler@0.9.2/astro.wasm";var A=Z(L());var $={getModuleUrl:(t,{isModule:o=!0,defaultCDN:d="jspm"}={})=>{let m=u=>{let e=o&&u.startsWith("unpkg:")?"?module":"";for(let s of V){let[c,i]=s;if(c.test(u))return u.replace(c,i)+e}return null},g=m(t)||m(d+":"+t);return g||(o?"https://jspm.dev/"+t:"https://cdn.jsdelivr.net/npm/"+t)},getModuleInfoUrl:t=>`https://api.npms.io/v2/search?q=${t}&size=1`},V=[[/^(jspm:)(.+)/i,"https://jspm.dev/$2"],[/^(skypack:)(.+)/i,"https://cdn.skypack.dev/$2"],[/^(jsdelivr:)(.+)/i,"https://cdn.jsdelivr.net/npm/$2"],[/^(jsdelivr.gh:)(.+)/i,"https://cdn.jsdelivr.net/gh/$2"],[/^(esm.run:)(.+)/i,"https://esm.run/$2"],[/^(esm.sh:)(.+)/i,"https://esm.sh/$2"],[/^(esbuild:)(.+)/i,"https://esbuild.vercel.app/$2"],[/^(bundle.run:)(.+)/i,"https://bundle.run/$2"],[/^(unpkg:)(.+)/i,"https://unpkg.com/$2"],[/^(github:)(.[^\/]+?)\/(.[^\/]+?)\/(?!releases\/)(?:(?:blob|raw)\/)?(.+?\/.+)/i,"https://raw.githack.com/$2/$3/$4"],[/^(github:)([^\/]+\/[^\/]+\/[^\/]+|[0-9A-Za-z-]+\/[0-9a-f]+\/raw)\/(.+)/i,"https://raw.githack.com/$2/$3"],[/^(gist\.github:)(.+?\/[0-9a-f]+\/raw\/(?:[0-9a-f]+\/)?.+)$/i,"https://gist.githack.com/$2"],[/^(gitlab:)([^\/]+.*\/[^\/]+)\/(?:raw|blob)\/(.+?)(?:\?.*)?$/i,"https://gl.githack.com/$2/raw/$3"],[/^(bitbucket:)([^\/]+\/[^\/]+)\/(?:raw|src)\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/$2/raw/$3"],[/^(bitbucket:)snippets\/([^\/]+\/[^\/]+)\/revisions\/([^\/\#\?]+)(?:\?[^#]*)?(?:\#file-(.+?))$/i,"https://bb.githack.com/!api/2.0/snippets/$2/$3/files/$4"],[/^(bitbucket:)snippets\/([^\/]+\/[^\/\#\?]+)(?:\?[^#]*)?(?:\#file-(.+?))$/i,"https://bb.githack.com/!api/2.0/snippets/$2/HEAD/files/$3"],[/^(bitbucket:)\!api\/2.0\/snippets\/([^\/]+\/[^\/]+\/[^\/]+)\/files\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/!api/2.0/snippets/$2/files/$3"],[/^(api\.bitbucket:)2.0\/snippets\/([^\/]+\/[^\/]+\/[^\/]+)\/files\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/!api/2.0/snippets/$2/files/$3"],[/^(rawgit:)(.+?\/[0-9a-f]+\/raw\/(?:[0-9a-f]+\/)?.+)$/i,"https://gist.githack.com/$2"],[/^(rawgit:)([^\/]+\/[^\/]+\/[^\/]+|[0-9A-Za-z-]+\/[0-9a-f]+\/raw)\/(.+)/i,"https://raw.githack.com/$2/$3"]];var O="https://dpaste.com/",X="https://dpaste.com/api/v2/",q="https://api2.livecodes.io/share",B={getProject:async t=>{try{let o=await fetch(O+t+".txt");return o.ok?JSON.parse(await o.text()):{}}catch{return{}}},shareProject:async t=>{try{let o=await fetch(X,{method:"POST",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded","User-Agent":"LiveCodes / https://livecodes.io/"},body:`content=${encodeURIComponent(JSON.stringify(t))}&title=${encodeURIComponent(t.title||"")}&syntax=json&expiry_days=365`});return o.ok?(await o.text()).replace(O,""):""}catch{return""}}},Y={getProject:async t=>{if(t.length<11)return B.getProject(t);if(!S())return{};try{let o=await fetch(q+"?id="+t);return o.ok?JSON.parse(await o.text()):{}}catch{return{}}},shareProject:async t=>{if(!S())return"";try{let o=await fetch(q,{method:"POST",mode:"cors",body:JSON.stringify(t)});return o.ok?o.text():""}catch{return""}}},ue=S()?Y:B;var I=/(import\s+?(?:(?:(?:[\w*\s{},\$]*)\s+from\s+?)|))((?:".*?")|(?:'.*?'))([\s]*?(?:;|$|))/g,tt=/(import\s*?\(\s*?((?:".*?")|(?:'.*?'))\s*?\))/g,et=t=>[...C(t).matchAll(new RegExp(I)),...C(t).matchAll(new RegExp(tt))].map(o=>o[2].replace(/"/g,"").replace(/'/g,"")),rt=t=>!t.startsWith("https://")&&!t.startsWith("http://")&&!t.startsWith(".")&&!t.startsWith("/")&&!t.startsWith("data:")&&!t.startsWith("blob:"),nt=(t,o)=>et(t).map(d=>{if(rt(d)){let m=Object.keys(o.imports).find(g=>g===d||d.startsWith(g+"/"));return m?{[m]:o.imports[m]}:{[d]:$.getModuleUrl(d,{defaultCDN:o?.customSettings?.defaultCDN})}}else return{}}).reduce((d,m)=>({...d,...m}),{});var W=(t,o)=>{let d=nt(t,o);return t.replace(new RegExp(I),m=>{let g=m.replace(new RegExp(I),"$2").replace(/"/g,"").replace(/'/g,""),u=Object.keys(d).find(e=>e===g||g.startsWith(e+"/"));return u?m.replace(u,d[u]):m})};var st=_+"index.min.js",ot=async(t,o)=>{t=W(t,o);let d=/^---((?:.|\n|\r)*)---((?:.|\n|\r)*)/,m=t.trim().match(new RegExp(d))?.[1];if(!m)return t;let g=await T(m,"typescript",o);return t.trim().replace(new RegExp(d),`---
${g}
---
$2`)};self.createAstroCompiler=()=>{let{transform:t,initialize:o,renderAstroToHTML:d}=self.astroCompiler,m=o({wasmURL:R});return async(g,{config:u})=>{await m;let e=await ot(g,u),s=await t(e,{sourcefile:"file.astro",sourcemap:!1,internalURL:st,...P("astro",u)}),c=await d(s.code);if(c.errors){for(let i of c.errors)console.warn(i);return""}return c}};})();
//# sourceMappingURL=lang-astro-compiler.js.map
